-- RENEWAL POLICIES ISSUE --
SELECT * FROM MT_VEHICLES_DETAILS VD 
WHERE VD.ASSORTED_CODE IN(
SELECT IAC.ASSORTED_CODE FROM INS_ASSORTED_CLIENTS IAC
WHERE IAC.ASSORTED_CODE IN(
SELECT IA.ASSORTED_CODE FROM INS_ASSORTED IA 
WHERE (
ia.assorted_string like '%85803%' or
ia.assorted_string like '%85805%' or
ia.assorted_string like '%85808%' or
ia.assorted_string like '%85810%' or
ia.assorted_string like '%85836%' or
ia.assorted_string like '%85840%' or
ia.assorted_string like '%85843%' or
ia.assorted_string like '%85845%' or
ia.assorted_string like '%85849%' or
ia.assorted_string like '%85853%' or
ia.assorted_string like '%85858%' or
ia.assorted_string like '%85882%' or
ia.assorted_string like '%85884%' or
ia.assorted_string like '%85887%' or
ia.assorted_string like '%85888%' or
ia.assorted_string like '%85889%' or
ia.assorted_string like '%85891%' or
ia.assorted_string like '%85895%' or
ia.assorted_string like '%85904%' or
ia.assorted_string like '%85907%' or
ia.assorted_string like '%85909%' or
ia.assorted_string like '%85918%' or
ia.assorted_string like '%85920%' or
ia.assorted_string like '%85923%' or
ia.assorted_string like '%85926%' or
ia.assorted_string like '%85927%' or
ia.assorted_string like '%85929%' or
ia.assorted_string like '%85930%' or
ia.assorted_string like '%85933%' or
ia.assorted_string like '%85937%' or
ia.assorted_string like '%85940%' or
ia.assorted_string like '%85945%' or
ia.assorted_string like '%85955%' or
ia.assorted_string like '%85962%' or
ia.assorted_string like '%85970%' or
ia.assorted_string like '%85975%'
)))


--QUERY 1:
UPDATE MT_VEHICLES_DETAILS X
SET START_DATE = (

SELECT ADD_MONTHS(START_DATE,12) FROM MT_VEHICLES_DETAILS
WHERE ASSORTED_CODE = (SELECT ASSORTED_CODE FROM TMP_MTR_RENEWAL WHERE CERT_ASSORTEd_CODE =X.ASSORTED_CODE)
),
END_DATE = (

SELECT ADD_MONTHS(END_DATE,12) FROM MT_VEHICLES_DETAILS
WHERE ASSORTED_CODE = (SELECT ASSORTED_CODE FROM TMP_MTR_RENEWAL WHERE CERT_ASSORTEd_CODE =X.ASSORTED_CODE)
)
WHERE ASSORTEd_CODE IN (SELECT ASSORTEd_CODE FROM INS_ASSORTED
WHERE GENERATE_AGAINST IN ('040000169033','040000169037','040000169040','040000169042',
'040000169072','040000169076','040000169080','040000169082','040000169086','040000169090','040000169096',
'040000169126','040000169130','040000169133','040000169134','040000169135','040000169137','040000169147',
'040000169159','040000169163','040000169166','040000169176','040000169178','040000169181','040000169185',
'040000169188','040000169191','040000169193','040000169196','040000169200','040000169204','040000169211',
'040000169222','040000169230','040000169238','040000169243')
AND ENT_BY = 'SYS')
--AND ASSORTED_CODE NOT IN ('070000148436','070000148437','070000148438','070000148439','070000148440')


--QUERY No:02
UPDATE INS_ASSORTED X
SET PERIOD_FROM = (

SELECT ADD_MONTHS(START_DATE,12) FROM MT_VEHICLES_DETAILS
WHERE ASSORTED_CODE = (SELECT ASSORTED_CODE FROM TMP_MTR_RENEWAL WHERE CERT_ASSORTEd_CODE =X.ASSORTED_CODE)
),
PERIOD_TO_DATE = (

SELECT ADD_MONTHS(END_DATE,12) FROM MT_VEHICLES_DETAILS
WHERE ASSORTED_CODE = (SELECT ASSORTED_CODE FROM TMP_MTR_RENEWAL WHERE CERT_ASSORTEd_CODE =X.ASSORTED_CODE)
)
WHERE ASSORTEd_CODE IN (SELECT ASSORTEd_CODE FROM INS_ASSORTED
WHERE GENERATE_AGAINST IN ('040000169033','040000169037','040000169040','040000169042',
'040000169072','040000169076','040000169080','040000169082','040000169086','040000169090','040000169096',
'040000169126','040000169130','040000169133','040000169134','040000169135','040000169137','040000169147',
'040000169159','040000169163','040000169166','040000169176','040000169178','040000169181','040000169185',
'040000169188','040000169191','040000169193','040000169196','040000169200','040000169204','040000169211',
'040000169222','040000169230','040000169238','040000169243')
AND ENT_BY = 'SYS')
--AND ASSORTED_CODE NOT IN ('070000148436','070000148437','070000148438','070000148439','070000148440')



SELECT * FROM INS_ASSORTED IA 
WHERE
(
IA.ASSORTED_STRING LIKE '%78809-00001-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00003-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00005-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00006-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00007-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00008-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00009-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00010-11-2023%' OR
IA.ASSORTED_STRING LIKE '%78809-00011-11-2023%' )
order by 1 asc for update
