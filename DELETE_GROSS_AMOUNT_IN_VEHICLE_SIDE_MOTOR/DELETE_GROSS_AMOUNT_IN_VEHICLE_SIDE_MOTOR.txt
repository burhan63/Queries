-- Delete Vehicle Side Gross Contribution --

Step No : 01.
-- Sub sy pehle apko assorted_code nikal laina hai.

Query:
select * from ins_assorted ia 
where ia.assorted_string like '%%';

-- or agar endorsement ka certificate hai tw

Query:
select * from ins_assorted ia 
where ia.end_string like '%%';

Step No: 02.
-- Assorted code nikal laine kai bad humain vehicle code nikal laina hai.

Query:
select * from mt_vehicles_details vd 
where vd.assorted_code = 'Assorted_code';


Step No : 03.
--Vehicle code nikalne kai bad humain ins_premium mai pehle assorted_code per daikhna
--hai kai (amount - previous amount) kai bad variation 0 araha ho agar araha hai
-- then humain vehicle_code reference_code mai dalna hai.

Query:
SELECT IP.PREMIUM_SEQNO,IP.PREMIUM_TYPE_CODE,IP.REFERENCE_CODE,IP.ORDER_NO,IP.AMOUNT,
IP.PREV_AMOUNT,(IP.AMOUNT-IP.PREV_AMOUNT) DIFFERENCE,IP.RATE, IP.CHARGE_CODE,IP.ENT_BY
FROM INS_PREMIUM IP
WHERE IP.REFERENCE_CODE = 'vehicle_code'
ORDER BY TO_NUMBER(IP.ORDER_NO) ASC
FOR UPDATE;

-- query run karne kai bad humain jo amount previous_amount mai dala hua hoga 
-- wo humain amount mai dal daina hai takai variation 0 ajaey bus gross 0 hojaey ga.
-- or yeh kam vehicle side per sub per karna hai.