-- SET GROSS CONTRIBUTION --
SELECT * FROM INS_ASSORTED IA 
--where (ia.assorted_code ='070000147991' or ia.generate_against='070000147991')
WHERE IA.ASSORTED_STRING LIKE '%38412-03-2024%'
and ia.policy_type_code = '76';

ASSORTED CODE: 040000146243
GENERATE AGAINST: -19,583
5685
-- CHECK INS_PREMIUM FOR CONTRIBUTION --
SELECT IP.PREMIUM_SEQNO,IP.PREMIUM_TYPE_CODE,IP.REFERENCE_CODE,IP.ORDER_NO,IP.AMOUNT,
IP.PREV_AMOUNT,(IP.AMOUNT-IP.PREV_AMOUNT) DIFFERENCE,IP.RATE, IP.CHARGE_CODE,IP.ENT_BY
FROM INS_PREMIUM IP
WHERE IP.REFERENCE_CODE = '050000729127'
ORDER BY TO_NUMBER(IP.ORDER_NO) ASC
FOR UPDATE;

select *
from ins_coinsurances ic
where ic.assorted_code='050000726582'


-- CHECK NET CONTRIBUTION CORRECTION
SELECT * FROM INS_COINSURANCES IC 
WHERE IC.ASSORTED_CODE = '040000169359';

SELECT func_get_amount_by_type(A.ASSORTED_CODE,'GROSS'),
  A.* FROM INS_ASSORTED A
WHERE NVL(POLICY_CODE,ASSORTED_CODE)='050000681559'


SELECT * FROM INS_PREMIUM
WHERE REFERENCE_CODE ='050000679228'

SELECT * FROM MT_VEHICLES_DETAILS VD 
WHERE VD.ASSORTED_CODE = '050000681559'

SELECT * FROM INS_ASSORTED 
WHERE GENERATE_AGAINST = '040000169359'
